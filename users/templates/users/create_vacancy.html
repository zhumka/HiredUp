<!DOCTYPE html>
{% load static %}
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Создание вакансии</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> <!-- Подключение jQuery для AJAX -->
    <link rel="stylesheet" type="text/css" href="{% static 'users/css/create_vacancy.css' %}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <h1>Создание вакансии</h1>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <!-- Поле для названия вакансии -->
        <label for="id_title">Название вакансии
            <span class="tooltip">?
                <span class="tooltip-text">Укажите название вакансии, которое точно отражает должностные обязанности.</span>
            </span>
        </label>
        {{ form.title }}

        <!-- Поле для описания вакансии -->
        <label for="id_requirements">Описание вакансии
            <span class="tooltip">?
                <span class="tooltip-text">Опишите основные требования и задачи, которые стоят перед кандидатом.</span>
            </span>
        </label>
        {{ form.requirements }}

        <!-- Поле для обязанностей -->
        <label for="id_responsibilities">Обязанности
            <span class="tooltip">?
                <span class="tooltip-text">Перечислите основные обязанности, которые будут возложены на кандидата.</span>
            </span>
        </label>
        {{ form.responsibilities }}

        <!-- Поля для минимальной и максимальной зарплаты -->
        <label for="id_salary_min">Минимальная зарплата
            <span class="tooltip">?
                <span class="tooltip-text">Укажите минимальный диапазон зарплаты для этой вакансии.</span>
            </span>
        </label>
        {{ form.salary_min }}

        <label for="id_salary_max">Максимальная зарплата
            <span class="tooltip">?
                <span class="tooltip-text">Укажите максимальный диапазон зарплаты для этой вакансии.</span>
            </span>
        </label>
        {{ form.salary_max }}

        <!-- Поле для выбора категории профессии -->
        <label for="id_category">Категория профессии
            <span class="tooltip">?
                <span class="tooltip-text">Выберите категорию, которая наиболее точно соответствует вакансии.</span>
            </span>
        </label>
        {{ form.category }}

        <!-- Поле для выбора профессии -->
        <label for="id_profession">Профессия
            <span class="tooltip">?
                <span class="tooltip-text">Выберите профессию, для которой создается вакансия.</span>
            </span>
        </label>
        {{ form.profession }}

        <!-- Поле для требуемого опыта -->
        <label for="id_experience_required">Требуемый опыт работы (в годах)
            <span class="tooltip">?
                <span class="tooltip-text">Укажите минимальное количество лет опыта, которые требуются для этой вакансии.</span>
            </span>
        </label>
        {{ form.experience_required }}
        {% if form.experience_required.errors %}
            <ul class="error-list">
                {% for error in form.experience_required.errors %}
                    <li>{{ error }}</li>
                {% endfor %}
            </ul>
        {% endif %}

        <!-- Поле для типа занятости -->
        <label for="id_job_type">Тип занятости
            <span class="tooltip">?
                <span class="tooltip-text">Выберите тип занятости: полная, частичная или временная.</span>
            </span>
        </label>
        {{ form.job_type }}

        <!-- Поле для места работы -->
        <label for="id_location">Место работы
            <span class="tooltip">?
                <span class="tooltip-text">Укажите место, где будет проходить работа.</span>
            </span>
        </label>
        {{ form.location }}

        <!-- Скрытое поле для статуса вакансии, которое будет установлено как активное по умолчанию -->
        {{ form.is_active }}

        <!-- Кнопка для отправки формы -->
        <button type="submit">Создать вакансию</button>
    </form>

    <!-- Скрипт для фильтрации профессий по категории -->
    <script>
        $('#id_category').change(function() {
            var categoryId = $(this).val();

            // Отправка AJAX-запроса для получения профессий по категории
            $.ajax({
                url: "{% url 'load_professions' %}",
                data: {
                    'category_id': categoryId
                },
                success: function(data) {
                    var professionSelect = $('#id_profession');
                    professionSelect.empty();  // Очистка существующих опций

                    // Добавление новой опции по умолчанию
                    professionSelect.append('<option value="">Выберите профессию</option>');

                    // Заполнение выпадающего списка новыми данными
                    $.each(data, function(key, value) {
                        professionSelect.append('<option value="' + value.id + '">' + value.name + '</option>');
                    });
                }
            });
        });
    </script>
</body>
</html>
