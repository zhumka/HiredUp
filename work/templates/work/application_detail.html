{% load static %}
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'work/css/application_detail.css' %}">
    <title>Детали отклика</title>
</head>
<body>
    <nav>
        <a href="{% url 'home' %}">Главная</a>
        {% if user.is_authenticated %}
            <a href="{% url 'applications' %}">Отклики</a>
            <a href="{% url 'profile' %}">Профиль</a>
            <form action="{% url 'logout' %}" method="POST" style="display: inline;">
                {% csrf_token %}
                <button type="submit" style="background: none; border: none; color: white; cursor: pointer;">Выйти</button>
            </form>
        {% else %}
            <a href="{% url 'login' %}">Войти</a>
            <a href="{% url 'register' %}">Зарегистрироваться</a>
        {% endif %}
    </nav>

    <header>
        <h1>Детали отклика</h1>
    </header>

    <!-- Отображение сообщений -->
    <section class="messages">
        {% if messages %}
            <ul class="message-list">
                {% for message in messages %}
                    <li class="message {{ message.tags }}">
                        {{ message }}
                    </li>
                {% endfor %}
            </ul>
        {% endif %}
    </section>

    <section class="application-detail">
        <!-- Блок с информацией о вакансии -->
        <div class="vacancy-info">
            <h2>Вакансия: {{ vacancy.title }}</h2>
            <p><strong>Компания:</strong> {{ vacancy.employer.company_name }}</p>
            <p><strong>Описание вакансии:</strong> {{ vacancy.description }}</p>
            <p><strong>Зарплата:</strong> {{ vacancy.salary_min }} - {{ vacancy.salary_max }} руб.</p>
            <p><strong>Требования:</strong> {{ vacancy.requirements }}</p>
            <p><strong>Обязанности:</strong> {{ vacancy.responsibilities }}</p>
            <p><strong>Местоположение:</strong> {{ vacancy.location }}</p>
            <p><strong>Тип работы:</strong> {{ vacancy.get_job_type_display }}</p>
            <p><strong>Опыт работы:</strong> {{ vacancy.experience_required }} лет</p>
        </div>

        <!-- Блок с информацией о соискателе -->
        <div class="job-seeker-info">
            <h3>Информация о соискателе</h3>
            <p><strong>Никнейм:</strong> {{ job_seeker.user.username }}</p>
            <p><strong>Имя:</strong> {{ job_seeker.user.first_name }}</p>
            <p><strong>Фамилия:</strong> {{ job_seeker.user.last_name }}</p>
            <p><strong>Почта:</strong> {{ job_seeker.user.email }}</p>

            <h4>Резюме:</h4>
            <p><strong>Образование:</strong> {{ job_seeker.resume.get_education_display }}</p>
            <p><strong>Навыки:</strong> {{ job_seeker.resume.skills }}</p>
            <p><strong>Опыт работы:</strong> {{ job_seeker.resume.experience }} лет</p>
            <p><strong>Знание языков:</strong> {{ job_seeker.resume.languages }}</p>

            {% if job_seeker.resume.file %}
                <p><strong>Резюме:</strong> <a href="{{ job_seeker.resume.file.url }}" target="_blank">Скачать резюме</a></p>
            {% else %}
                <p>Резюме не прикреплено.</p>
            {% endif %}
        </div>

        <!-- Блок с кнопками для принятия или отклонения отклика -->
        <div class="application-actions">
            <h3>Подтвердить отклик:</h3>
            {% if application.status != 'accepted' and application.status != 'rejected' %}
                <form method="POST" action="{% url 'update_application_status' application.id %}">
                    {% csrf_token %}
                    <input type="hidden" name="status" value="accepted">
                    <button type="submit">Принять отклик</button>
                </form>
                <form method="POST" action="{% url 'update_application_status' application.id %}">
                    {% csrf_token %}
                    <input type="hidden" name="status" value="rejected">
                    <button type="submit">Отклонить отклик</button>
                </form>
            {% else %}
                <p>Статус отклика уже изменен. Он не может быть изменен повторно.</p>
            {% endif %}
        </div>
    </section>
</body>
</html>
